(function(h){function v(p,m){function k(){if(w)q();else{var j=document.createElement("script");j.src="http://www.youtube.com/player_api";var l=document.getElementsByTagName("script")[0];l.parentNode.insertBefore(j,l);window.onYouTubePlayerAPIReady=function(){q()}}}function q(){a=new YT.Player(i[0],{events:{onReady:function(){o=true;if(e.settings.reachVideoAction=="playVideo"&&!f){f=true;n()}},onStateChange:function(j){switch(j.data){case YT.PlayerState.BUFFERING:if(!g){g=true;c("start")}break;case YT.PlayerState.PLAYING:if(!g){g=
true;c("start")}if(!d){d=true;c("play")}break;case YT.PlayerState.PAUSED:if(d){d=false;c("pause")}break;case YT.PlayerState.ENDED:d=false;c("end")}}}})}function x(){a=Froogaloop(i[0]);a.addEvent("ready",function(){o=true;if(e.settings.reachVideoAction=="playVideo"&&!f){f=true;n()}a.addEvent("loadProgress",function(){if(!g){g=true;c("start")}});a.addEvent("play",function(){if(!g){g=true;c("start")}if(!d){d=true;c("play")}});a.addEvent("pause",function(){if(d){d=false;c("pause")}});a.addEvent("finish",
function(){d=false;c("end")})})}function y(){VideoJS(i.attr("id")).ready(function(){a=this;o=true;if(e.settings.reachVideoAction=="playVideo"&&!f){f=true;n()}a.addEvent("play",function(){if(!g){g=true;c("start")}if(!d){d=true;c("play")}});a.addEvent("pause",function(){if(d){d=false;c("pause")}});a.addEvent("ended",function(){d=false;c("end")});a.addEvent("enterFullWindow",function(){c("fullscreenchange")});a.addEvent("exitFullWindow",function(){c("fullscreenchange")})})}function z(){if(A)r();else var j=
setInterval(function(){if(sublimevideo.prepare){clearInterval(j);r()}},100)}function r(){if(e.settings.reachVideoAction=="playVideo"&&!f){f=true;n()}sublimevideo.onStart(function(){c("start");c("play")});sublimevideo.onEnd(function(){c("end")})}function B(){a=i[0];o=true;if(e.settings.reachVideoAction=="playVideo"&&!f){f=true;n()}a.addEventListener("play",function(){if(!g){g=true;c("start")}if(!d){d=true;c("play")}});a.addEventListener("pause",function(){if(d){d=false;c("pause")}});a.addEventListener("ended",
function(){d=false;c("end")})}function n(){if(b=="youtube-video")a.playVideo();else if(b=="vimeo-video")a.api("play");else if(b=="html5-video-js")a.play();else if(b=="html5-sublime-video")sublimevideo.play();else b=="html5-video"&&a.play()}function s(){if(b=="youtube-video"){a.seekTo(1);a.stopVideo()}else if(b=="vimeo-video"){a.api("pause");a.api("unload")}else if(b=="html5-video-js"){a.currentTime(0);a.pause()}else if(b=="html5-sublime-video")sublimevideo.stop();else if(b=="html5-video"){a.currentTime=
0;a.pause()}}function t(){if(b=="youtube-video")a.pauseVideo();else if(b=="vimeo-video")a.api("pause");else if(b=="html5-video-js")a.pause();else if(b=="html5-sublime-video")sublimevideo.stop();else b=="html5-video"&&a.pause()}function u(){if(b=="youtube-video")a.stopVideo();else if(b=="vimeo-video")a.api("pause");else if(b=="html5-video-js")a.pause();else if(b=="html5-sublime-video")sublimevideo.stop();else b=="html5-video"&&a.pause()}function c(j){var l={type:j};switch(j){case "start":h.isFunction(e.settings.start)&&
e.settings.start.call(this,l);break;case "play":h.isFunction(e.settings.play)&&e.settings.play.call(this,l);break;case "pause":h.isFunction(e.settings.pause)&&e.settings.pause.call(this,l);break;case "end":h.isFunction(e.settings.end)&&e.settings.end.call(this,l);break;case "fullscreenchange":h.isFunction(e.settings.fullscreenchange)&&e.settings.fullscreenchange.call(this,l)}}this.settings=h.extend({},h.fn.videoController.defaults,m);var i=h(p),e=this,b,a,w=window.YT&&window.YT.Player,A=window.sublimevideo&&
window.sublimevideo.prepare,o=false,f=false,g=false,d=false;if(i.is("iframe")&&i.attr("src").indexOf("youtube")!=-1)b="youtube-video";else if(i.is("iframe")&&i.attr("src").indexOf("vimeo")!=-1)b="vimeo-video";else if(i.hasClass("video video-js"))b="html5-video-js";else if(i.hasClass("video sublime-video")&&window.sublimevideo)b="html5-sublime-video";else if(i.is("video")&&i.hasClass("video")&&!(h.browser.msie&&parseInt(h.browser.version)<9))b="html5-video";switch(b){case "youtube-video":k();break;
case "vimeo-video":x();break;case "html5-video-js":y();break;case "html5-sublime-video":z();break;case "html5-video":B()}this.reachVideo=function(){if(e.settings.reachVideoAction=="playVideo"&&o&&!f){f=true;n()}};this.leaveVideo=function(){f=false;if(g&&a||b=="html5-sublime-video")if(e.settings.leaveVideoAction=="stopVideo")s();else if(e.settings.leaveVideoAction=="pauseVideoAndBuffering")u();else e.settings.leaveVideoAction=="pauseVideo"&&t()};this.stopVideo=s;this.pauseVideo=t;this.pauseVideoAndBuffering=
u}h.fn.videoController=function(p){for(var m=[],k=0;k<this.length;k++){if(!this[k].videoControllerInstance)this[k].videoControllerInstance=new v(this[k],p);m.push(this[k].videoControllerInstance)}return m.length>1?m:m[0]};h.fn.videoController.defaults={start:null,play:null,pause:null,end:null,fullscreenchange:null,reachVideoAction:"none",leaveVideoAction:"pauseVideo"}})(jQuery);
